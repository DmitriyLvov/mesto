(()=>{"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n=t((function e(t,n,o,i){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"_cardItem",void 0),r(this,"_cardPicture",void 0),r(this,"getCard",(function(){return c._cardItem})),r(this,"_likePicture",(function(){c._cardLikeButton.classList.toggle("elements__like_actived")})),r(this,"_scalePicture",(function(){c._scalePictureFunction(c._cardPircture.alt,c._cardPircture.src)})),r(this,"_removeCard",(function(){c._cardItem.remove()})),r(this,"_setEventListeners",(function(){c._cardPircture.addEventListener("click",c._scalePicture),c._cardLikeButton.addEventListener("click",c._likePicture),c._cardDeleteButton.addEventListener("click",c._removeCard)}));var u=document.querySelector(o).content;this._cardItem=u.querySelector(".elements__item").cloneNode(!0),this._cardItem.querySelector(".elements__title").textContent=t,this._cardPircture=this._cardItem.querySelector(".elements__image"),this._cardPircture.src=n,this._cardPircture.alt=t,this._scalePictureFunction=i,this._cardLikeButton=this._cardItem.querySelector(".elements__like"),this._cardDeleteButton=this._cardItem.querySelector(".elements__delete-button"),this._setEventListeners()}));function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"toggleButtonState",(function(){n._form.checkValidity()?(n._submitButton.classList.remove(n._inactiveButtonClass),n._submitButton.disabled=!1):(n._submitButton.classList.add(n._inactiveButtonClass),n._submitButton.disabled=!0)})),i(this,"clearAllErrorMessages",(function(){n._inputs.forEach((function(e){return n._hideInputError(e)}))})),i(this,"_showInputError",(function(e){e.classList.add(n._inputErrorClass);var t=n._form.querySelector(".popup__error_type_".concat(e.id));t.textContent=e.validationMessage,t.classList.add(n._errorClass)})),i(this,"_hideInputError",(function(e){e.classList.remove(n._inputErrorClass);var t=document.querySelector(".popup__error_type_".concat(e.id));t.classList.remove(n._errorClass),t.textContent=""})),i(this,"enableValidation",(function(){n._inputs.forEach((function(e){e.addEventListener("input",(function(){return n._handleInput(e)}))}))})),this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=r,this._inputs=Array.from(this._form.querySelectorAll(t.inputSelector)),this._submitButton=r.querySelector(t.submitButtonSelector)}var t,r;return t=e,(r=[{key:"_handleInput",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e),this.toggleButtonState()}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"_handleEscClose",(function(e){"Escape"===e.code&&r.close()})),a(this,"_closeFunction",(function(e){1===e.which&&(e.target.classList.contains("popup_opened")&&r.close(),e.target.classList.contains("popup__close-button")&&r.close())})),this._popup=document.querySelector(t)}var t,r;return t=e,(r=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){this._popup.addEventListener("mousedown",this._closeFunction)}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=d(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},f.apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}const v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(c,e);var t,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(o){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return y(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e))._image=t._popup.querySelector(".popup__image"),t._imageDescription=t._popup.querySelector(".popup__description"),t}return t=c,(r=[{key:"open",value:function(e,t){this._image.src=t,this._image.alt=e,this._imageDescription.textContent=e,f(h(c.prototype),"open",this).call(this)}}])&&p(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(s);function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t,r){var n=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=n,this._renderer=o,this._section=document.querySelector(r)}var t,r;return t=e,(r=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){var r=e._renderer(t);e._section.prepend(r)}))}},{key:"addItem",value:function(e){this._section.prepend(e)}}])&&b(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function O(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(){return P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=S(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},P.apply(this,arguments)}function S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(c,e);var t,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(n);if(o){var r=j(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return O(this,e)});function c(e,t){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),C(k(n=i.call(this,e)),"setEventListeners",(function(){P((r=k(n),j(c.prototype)),"setEventListeners",r).call(r),n._form.addEventListener("submit",n._handleSubmit)})),C(k(n),"setInputsData",(function(e){Object.entries(e).forEach((function(e){n._form.querySelector(".popup__text-input_type_".concat(e[0])).value=e[1]}))})),n._form=n._popup.querySelector(".popup__container_type_form"),n._handleSubmit=function(e){return t(e,n._getInputValues(),k(n))},n}return t=c,(r=[{key:"_getInputValues",value:function(){var e={};return Array.from(this._form).forEach((function(t){"INPUT"===t.nodeName&&(e[t.id]=t)})),e}},{key:"close",value:function(){P(j(c.prototype),"close",this).call(this),this._form.reset()}}])&&w(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(s);function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var B=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._author=document.querySelector(t),this._description=document.querySelector(r)}var t,r;return t=e,(r=[{key:"getUserInfo",value:function(){return{author:this._author.textContent,description:this._description.textContent}}},{key:"setUserInfo",value:function(e,t){this._author.textContent=e,this._description.textContent=t}}])&&I(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),q={},x=document.querySelector(".popup_type_profile").querySelector('[name = "edit-profile-form"]'),R=document.querySelector(".profile__edit-button"),V=document.querySelector(".popup_type_card").querySelector('[name = "add-card-form"]'),D=document.querySelector(".profile__add-button"),T=new v(".popup_type_image");function A(e){return new n(e.name,e.link,"#card-template",(function(e,t){return T.open(e,t)})).getCard()}T.setEventListeners();var U=new m({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:A},".elements");U.renderItems();var F=new B(".profile__text-field_type_author",".profile__text-field_type_description"),M={formSelector:".popup__container_type_form",inputSelector:".popup__text-input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__text-input_type_error",errorClass:"popup__error_visible"};q.profileValidator=new c(M,x),q.profileValidator.enableValidation();var N=new L(".popup_type_profile",(function(e,t,r){e.preventDefault(),Object.values(t).some((function(e){return!1===e.validity.valid}))||r.userInfo.setUserInfo(t.author.value,t.description.value),r.close()}));N.setEventListeners(),R.addEventListener("click",(function(){return function(e,t){t.setInputsData(e.getUserInfo()),q.profileValidator.clearAllErrorMessages(),q.profileValidator.toggleButtonState(),t.open(),t.userInfo=e}(F,N)}));var z=new L(".popup_type_card",(function(e,t,r){e.preventDefault();var n={name:t.name.value,link:t.path.value};U.addItem(A(n)),r.close()}));z.setEventListeners(),q.cardValidator=new c(M,V),q.cardValidator.enableValidation(),D.addEventListener("click",(function(){return e=z,q.cardValidator.clearAllErrorMessages(),q.cardValidator.toggleButtonState(),void e.open();var e}))})();